package blueprint

import (
	"bytes"
	"net/http"
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestEncodeBlueprint(t *testing.T) {
	resp, err := http.Get("https://raw.githubusercontent.com/raynquist/balancer/0bdafe7e7fe3137f17b1b39242c66152ad19094a/blueprints/balancer_book.txt")
	assert.NoError(t, err)

	var b Book
	err = Decode(resp.Body, &b)
	assert.NoError(t, err)

	var buf bytes.Buffer
	err = Encode(b.Blueprints[0].Entry, &buf)
	assert.NoError(t, err)

	assert.EqualValues(t, buf.String(), "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")
}
